<HTML>
<HEAD>
<TITLE>Twitch Chat Exploder</TITLE>
 
<meta charset="utf-8">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" href="style.css">
<script type="text/javascript"
    src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
    <script type="text/javascript"
    src="twitchers.js"></script>
<script>
    
var kappaLink = "http://static-cdn.jtvnw.net/emoticons/v1/25/1.0";

function Message(name, message) {
    this.name = name;
    this.message = message;
}

    var spamPercentage = 60;
    var casualPercentage = 90;
    var goodPercentage = 100;
    var prevMsg = 0;
    function doSomething() {
        var whichGroup = Math.floor((Math.random() * 100)); 
        if (whichGroup < spamPercentage)
            var messages = spamMessages;
        else if (whichGroup < casualPercentage) 
            var messages = casualMessages;
        else 
            var messages = goodMessages_set1;
        var x = Math.floor((Math.random() * messages.length)); 
        while (prevMsg == x)
            x = Math.floor((Math.random() * messages.length)); 
        var newMsg = $("<div class=\"message\"></div>");
        var msgName = $("<span class=\"name "+messages[x].color+"\">"+messages[x].name+"</span>");
        var msgContent = $("<span class=\"message_content\">"+messages[x].message+"</span>");
        newMsg.append(msgName);
        newMsg.append(msgContent);

        //console.log(x);
        $('#show').append(newMsg);
        //$('#show').append(document.createElement('br'));
        document.getElementById( 'bottom' ).scrollIntoView();


        var objDiv = document.getElementById("show");
        objDiv.scrollTop = objDiv.scrollHeight;
        prevMsg = x;
    }
    //var x = 0;
    $(document).ready(
            function() {
                (function loop() {
                    var rand = Math.round(Math.random() * (1000)) + 500;
                    setTimeout(function() {
                        doSomething();
                        loop();  
                    }, rand);
                }());
                /*
                setInterval(function() {
                    var newMsg = $("<div class=\"message\"></div>");
                    var msgName = $("<span class=\"name "+messages[x].color+"\">"+messages[x].name+"</span>");
                    var msgContent = $("<span class=\"message_content\">"+messages[x].message+"</span>");
                    newMsg.append(msgName);
                    newMsg.append(msgContent);

                    x = Math.floor((Math.random() * messages.length) + 1); 
                    $('#show').append(newMsg);
                    //$('#show').append(document.createElement('br'));
                    //document.getElementById( 'bottom' ).scrollIntoView();
                    

                    var objDiv = document.getElementById("show");
                    objDiv.scrollTop = objDiv.scrollHeight;
                    
                    //time = Math.floor((Math.random() * 100) + 200); 
                }, 100);
                */
            });
</script>
 
</HEAD>
<BODY>
    <div id="chatbox" class="exploder">
        <div class="chat-header">
            <i class="fa fa-align-left"></i>
            <div>Welcome to the chat</div>
        </div>
        <div id="show" class="exploder" align="center"></div>
        <div id="bottom"></div>
        <div class="send_message">
            <input placeholder="Send a message"></input>
            <i class="fa fa-cog"></i>
            <i class="fa fa-list-ul"></i>
            <button>Chat</button>
        </div>
    </div>
    
</BODY>
</HTML>